<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <style>
    body { font-family: 'Inter', 'Segoe UI', sans-serif; color:#0f172a; margin:0; padding:0; }
    .cover { background:#0ea5e9; color:white; padding:48px; text-align:center; }
    .section { padding:24px 48px; }
    h1,h2,h3 { margin:0 0 12px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; font-size:12px; }
    th,td { padding:8px; border:1px solid #e2e8f0; }
    .kpi-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(180px,1fr)); gap:12px; }
    .kpi-card { background:#f8fafc; border-radius:8px; padding:12px; border:1px solid #e2e8f0; }
  </style>
</head>
<body>
  <section class="cover">
    <img src="{{ logo_path }}" alt="Logo" style="height:80px;margin-bottom:16px;"/>
    <h1>Informe {{ titulo }}</h1>
    <p>Emitido: {{ emitido }} · Rango: {{ rango }}</p>
    <p>Filtros activos: {{ filtros|default('Todos', true) }}</p>
  </section>
  <section class="section">
    <h2>Indicadores principales</h2>
    <div class="kpi-grid">
      {% for kpi in kpis %}
      <div class="kpi-card">
        <h3>{{ kpi.label }}</h3>
        <p style="font-size:24px;font-weight:700;">{{ kpi.value }}</p>
        <small>{{ kpi.note }}</small>
      </div>
      {% endfor %}
    </div>
  </section>
  <section class="section">
    <h2>Gráficos</h2>
    {% for chart in charts %}
      <img src="{{ chart }}" style="width:100%;margin-bottom:16px;border:1px solid #e2e8f0;border-radius:8px;" />
    {% endfor %}
  </section>
  <section class="section">
    <h2>Resumen por sede/persona</h2>
    <table>
      <thead>
        <tr>
          {% for col in tabla.columns %}
          <th>{{ col }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for fila in tabla.rows %}
        <tr>
          {% for value in fila %}
          <td>{{ value }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</body>
</html>
